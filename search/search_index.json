{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"HumeSQL","text":"<p>HumeSQL converts natural language into safe SQL, executes it against your MySQL/MariaDB database, and returns JSON rows. It introspects your schema, prompts Gemini to craft SQL, applies guardrails, executes, and responds with the SQL, reasoning, and results.</p>"},{"location":"#why-humesql","title":"Why HumeSQL?","text":"<ul> <li>Ask questions in plain English; get SQL and JSON back.</li> <li>Safe by default: blocks destructive SQL, limits large queries, only touches your schema.</li> <li>Works with MySQL/MariaDB using <code>mysql-connector-python</code>.</li> <li>Python API and CLI with schema caching and debug output.</li> </ul>"},{"location":"#quick-start","title":"Quick start","text":"<pre><code>pip install humesql\nexport HUMESQL_AI_KEY=\"your-gemini-key\"\n</code></pre> <pre><code>from humesql import HumeSQL\n\ndb = {\"host\":\"localhost\",\"user\":\"root\",\"password\":\"\",\"database\":\"classicmodels\",\"port\":3306}\nh = HumeSQL(db, model=\"gemini-2.5-flash\")\nprint(h.query(\"last 5 customers from Nepal\", debug=True))\n</code></pre> <p>Continue to Getting Started for setup details.</p>"},{"location":"api/","title":"Python API","text":""},{"location":"api/#humesql","title":"HumeSQL","text":"<pre><code>HumeSQL(\n    db_config: dict,\n    model: str = \"gemini-2.5-flash\",\n    api_key: str | None = None,\n    cache_schema: bool = True,\n)\n</code></pre>"},{"location":"api/#methods","title":"Methods","text":"<p><code>query(user_text: str, debug: bool = False) -&gt; dict</code> - Returns a dict with keys: <code>ok</code>, <code>error</code>, <code>sql</code>, <code>reasoning</code>, <code>limit_applied</code>, <code>rows</code>, <code>time_ms</code>, and <code>raw_ai_response</code> when <code>debug=True</code>. - Applies guardrails: blocks dangerous SQL, adds <code>LIMIT 100</code> when missing on SELECT, rejects non-JSON AI output.</p> <p><code>refresh_schema_cache() -&gt; None</code> - Forces a reload of the database schema even when caching is enabled.</p>"},{"location":"api/#result-shape","title":"Result shape","text":"<pre><code>{\n  \"ok\": true,\n  \"error\": null,\n  \"sql\": \"SELECT ...\",\n  \"reasoning\": \"short explanation\",\n  \"limit_applied\": true,\n  \"rows\": [ {\"col\": \"val\"} ],\n  \"time_ms\": 123.45,\n  \"raw_ai_response\": \"...\"   // present only with debug=True\n}\n</code></pre>"},{"location":"api/#example","title":"Example","text":"<pre><code>from humesql import HumeSQL\n\ndb = {\n    \"host\": \"localhost\",\n    \"user\": \"root\",\n    \"password\": \"\",\n    \"database\": \"classicmodels\",\n    \"port\": 3306,\n}\n\nh = HumeSQL(db, model=\"gemini-2.5-flash\")\nres = h.query(\"top 5 customers from Nepal\", debug=True)\n\nif res[\"ok\"]:\n    print(res[\"sql\"])\n    print(res[\"rows\"])\nelse:\n    print(\"Error:\", res[\"error\"])\n</code></pre>"},{"location":"cli/","title":"CLI","text":"<p>HumeSQL ships a <code>humesql</code> command for quick, one-off natural language queries.</p>"},{"location":"cli/#basic-example","title":"Basic example","text":"<pre><code>humesql \"last 5 customers from Nepal\" \\\n  -H localhost -u root -p \"\" -d classicmodels --port 3306 \\\n  --api-key \"$HUMESQL_AI_KEY\" --model gemini-2.5-flash --debug\n</code></pre>"},{"location":"cli/#arguments","title":"Arguments","text":"<ul> <li><code>query</code> (positional): natural language prompt.</li> <li><code>-H, --host</code>: database host (required).</li> <li><code>-u, --user</code>: database user (required).</li> <li><code>-p, --password</code>: database password (default: empty).</li> <li><code>-d, --database</code>: database name (required).</li> <li><code>--port</code>: database port (default: 3306).</li> <li><code>--api-key</code>: Gemini API key; overrides env vars.</li> <li><code>--model</code>: Gemini model (default: <code>gemini-2.5-flash</code>).</li> <li><code>--no-cache-schema</code>: disable schema caching.</li> <li><code>--debug</code>: include the raw AI response in JSON output.</li> </ul> <p>Exit code <code>0</code> on success, <code>1</code> on error.</p>"},{"location":"cli/#output","title":"Output","text":"<p>Printed as JSON and matches the Python API shape. On errors, <code>ok</code> is <code>false</code> and <code>error</code> contains details.</p>"},{"location":"configuration/","title":"Configuration","text":""},{"location":"configuration/#api-key-resolution","title":"API key resolution","text":"<p>Order of precedence: 1. Explicit <code>api_key</code> argument 2. <code>HUMESQL_AI_KEY</code> (preferred) 3. <code>HUMANSQL_AI_KEY</code> (legacy) 4. <code>GEMINI_API_KEY</code></p> <p>Export an environment variable, e.g.:</p> <pre><code>export HUMESQL_AI_KEY=\"your-gemini-key\"\n</code></pre>"},{"location":"configuration/#database-connection","title":"Database connection","text":"<p>Provide a dict:</p> <pre><code>db_config = {\n    \"host\": \"localhost\",\n    \"user\": \"root\",\n    \"password\": \"\",\n    \"database\": \"classicmodels\",\n    \"port\": 3306,\n}\n</code></pre> <p>MySQL-specific notes: - Ensure the host/port is reachable from where you run the client. - Use a user with read permissions for the tables you need. - <code>mysql-connector-python</code> must be installed (it is a dependency of HumeSQL).</p>"},{"location":"configuration/#model-selection","title":"Model selection","text":"<ul> <li>Default: <code>gemini-2.5-flash</code></li> <li>Override: <code>HumeSQL(..., model=\"gemini-1.5-pro-latest\")</code> or CLI <code>--model gemini-1.5-pro-latest</code></li> <li>Make sure your API key has access to the chosen model.</li> </ul>"},{"location":"configuration/#schema-caching","title":"Schema caching","text":"<ul> <li>Enabled by default: <code>cache_schema=True</code></li> <li>Disable: <code>HumeSQL(..., cache_schema=False)</code> or CLI <code>--no-cache-schema</code></li> <li>Refresh manually after schema changes: <code>h.refresh_schema_cache()</code></li> </ul>"},{"location":"configuration/#debugging","title":"Debugging","text":"<ul> <li>Set <code>debug=True</code> in <code>.query(...)</code> or pass <code>--debug</code> to the CLI.</li> <li>In debug mode, the raw AI response is included in the result for inspection.</li> </ul>"},{"location":"faq/","title":"FAQ","text":"<p>Is this production-ready? HumeSQL provides guardrails and uses parameterized execution, but you should review outputs, apply least-privilege DB access, and add your own auditing/limits for production environments.</p> <p>Which databases are supported? MySQL and MariaDB via <code>mysql-connector-python</code>. Other engines would require additional adapters.</p> <p>Can I disable schema caching? Yes: <code>cache_schema=False</code> in Python or <code>--no-cache-schema</code> via CLI. You can also call <code>refresh_schema_cache()</code> after schema changes.</p> <p>How do I select a different Gemini model? Pass <code>model=\"gemini-1.5-pro-latest\"</code> (Python) or <code>--model gemini-1.5-pro-latest</code> (CLI). Ensure your API key has access.</p> <p>How are API keys resolved? Order: <code>api_key</code> argument &gt; <code>HUMESQL_AI_KEY</code> &gt; <code>HUMANSQL_AI_KEY</code> (legacy) &gt; <code>GEMINI_API_KEY</code>.</p>"},{"location":"getting-started/","title":"Getting Started","text":""},{"location":"getting-started/#requirements","title":"Requirements","text":"<ul> <li>Python 3.9+</li> <li>MySQL/MariaDB reachable from your environment</li> <li>Gemini API key with access to your desired model</li> </ul>"},{"location":"getting-started/#installation","title":"Installation","text":"<p>PyPI:</p> <pre><code>pip install humesql\n</code></pre> <p>From source (editable):</p> <pre><code>pip install -e .\n</code></pre>"},{"location":"getting-started/#configure-credentials","title":"Configure credentials","text":""},{"location":"getting-started/#ai-key-order","title":"AI key order","text":"<ol> <li>Explicit <code>api_key</code> argument  </li> <li><code>HUMESQL_AI_KEY</code> (preferred)  </li> <li><code>HUMANSQL_AI_KEY</code> (legacy)  </li> <li><code>GEMINI_API_KEY</code></li> </ol> <p>Set an environment variable:</p> <pre><code>export HUMESQL_AI_KEY=\"your-gemini-key\"\n</code></pre>"},{"location":"getting-started/#database-config","title":"Database config","text":"<p>Pass a dict to the client:</p> <pre><code>db = {\n    \"host\": \"localhost\",\n    \"user\": \"root\",\n    \"password\": \"\",\n    \"database\": \"classicmodels\",\n    \"port\": 3306,\n}\n</code></pre>"},{"location":"getting-started/#first-query-python","title":"First query (Python)","text":"<pre><code>from humesql import HumeSQL\n\nh = HumeSQL(db_config=db, model=\"gemini-2.5-flash\")\nres = h.query(\"show me the last 5 users from Nepal\", debug=True)\nprint(res)\n</code></pre>"},{"location":"getting-started/#first-query-cli","title":"First query (CLI)","text":"<pre><code>humesql \"last 5 customers from Nepal\" \\\n  -H localhost -u root -p \"\" -d classicmodels --port 3306 \\\n  --api-key \"$HUMESQL_AI_KEY\" --model gemini-2.5-flash --debug\n</code></pre> <p>Exit code <code>0</code> on success, <code>1</code> on errors.</p>"},{"location":"tips/","title":"Prompting Tips","text":"<ul> <li>Be explicit about filters: \u201clast 5 orders from customers in Nepal\u201d.</li> <li>Mention known entities: table/column hints help the model pick correct joins.</li> <li>State aggregations and ranges: \u201caverage order value per month in 2023\u201d.</li> <li>Clarify sorting/limits: \u201corder by signup_date desc limit 10\u201d.</li> <li>Use clear units: \u201cwithin the last 30 days\u201d, \u201cUSD total\u201d.</li> </ul> <p>If results look off, tighten the prompt with table/column names you know exist.</p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":"<ul> <li> <p>API key not valid   Confirm <code>HUMESQL_AI_KEY</code> (or <code>--api-key</code>) and ensure the key has access to your chosen Gemini model.</p> </li> <li> <p>Model not found (404)   Use a supported model, e.g., <code>--model gemini-2.5-flash</code>.</p> </li> <li> <p>Database connection errors   Check host/port/user/password and make sure MySQL/MariaDB is reachable.</p> </li> <li> <p>Malformed JSON from model   Rerun with <code>debug=True</code> (or <code>--debug</code>) to see <code>raw_ai_response</code>. The JSON sanitizer helps, but non-JSON output will be rejected.</p> </li> <li> <p>Schema changes not reflected   Call <code>refresh_schema_cache()</code> or disable schema caching with <code>cache_schema=False</code> / <code>--no-cache-schema</code>.</p> </li> </ul>"}]}